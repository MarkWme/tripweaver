# PAM Security Hardening Configuration for TripWeaver
# Mitigates CVE-2025-8941 privilege escalation vulnerability in libpam0g
#
# This configuration disables pam_namespace and implements secure PAM policies

# Disable pam_namespace module completely to prevent CVE-2025-8941 exploitation
# This module is not needed for containerized applications
auth    sufficient    pam_unix.so nullok
account sufficient    pam_unix.so
password sufficient   pam_unix.so
session  sufficient   pam_unix.so

# For systems that may still have pam_namespace configured elsewhere,
# create an empty namespace.conf to prevent symlink attacks
# The container should have this file owned by root with restrictive permissions